---
title: "Santa Barbara Urchins"
author: "Katherine Rosencrance"
date: "10/25/2021"
output: html_document
---

# Overview

This code wrangles and visualizes data for red and purple urchins obtained by Santa Barbara Coastal Long Term Ecological Research program divers. These data were collected in 2020 along 5 different long-term kelp removal sites. It has been wrangled to draw conclusions about

**Data Citation** Santa Barbara Coastal LTER and D. Reed. 2020. SBC LTER: Reef: Long-term experiment: Kelp removal: Urchin size frequency distribution ver 20. Environmental Data Initiative. https://doi.org/10.6073/pasta/5a1e9ef03aa47bd2225c0bb98a02a63b (Accessed 2021-10-25).

#Setup
Attach the appropriate packages.
```{r setup }
knitr::opts_chunk$set(echo = TRUE, message = FALSE, warning = FALSE) #we do not want messages or warnings showing up in our entire html
library(tidyverse)
library(here)
library(janitor)
library(kableExtra)
library(lubridate)

```


#Read in the Data
Read in the data and change all the column titles to be in lower_snake_case.
```{r}
urchins <- read_csv(here("data", "urchins.csv")) %>% 
  clean_names()           #convert to lower_snake_case
```

# Wrangle and Visualize the Data
Create a histogram to compare the distribution of sizes between red and purple urchins

### Histogram of Purple and Red Sea Urchin Size 
```{r}
ggplot(data = urchins,
       aes(x = size, fill = common_name))+
  scale_fill_manual(values = c("purple", "red"), name = "Common name") +
         geom_histogram(bins = 10, color = "black") +
  facet_wrap(~common_name) +
  labs( x = "Diameter (cm)",
        y = "Number of Urchins",
        title = "Red and Purple Urchin Size Distribution")+

## Title adjustment
theme(plot.title = element_text (face = "bold", hjust = 0.5))

```
Figure 1. 


### Table with Summary Statistics
```{r}
urchins %>% 
  group_by(common_name) %>% 
  summarize(mean_size = mean(size, na.rm = TRUE),   ## Create summary statistics including mean, standard deviation, and sample size
            median_size = median(size, na.rm = TRUE),
            sd_size = sd(size, na.rm = TRUE),
            sample_size = n()) %>% 

kbl(caption = "Table 1: Summary Statistics of Red and Purple Urchin Size",
    col.names = c("Common Name",
                  "Mean (cm)",
                  "Median (cm)",
                  "Standard Deviation (cm)",
                  "Sample Size"),
    digits = 1) %>% 
  kable_minimal()

            
```
## Summary Statistics for Purple Urchins only
```{r}
purple_urchins <- urchins %>% 
  filter(common_name == "Purple Urchin") %>% 
  mutate(date_new = mdy(date)) %>%  ##use mdy because that is the way they are listed here
  mutate(year = year(date_new)) %>% 
  mutate(site_full = case_when(
    site == "NAPL" ~ "Naples Reef",
    site == "AQUE" ~ "Arroyo Quemado Reef",
    site == "CARP" ~ "Carpinteria Reef",
    site == "IVEE" ~ "Isla Vista Reef",
    site == "MOHK" ~ "Mohawk Reef"))
  
```

```{r}
purple_urchins_table <- purple_urchins %>% 
  group_by(site_full, year) %>% 
  summarize(sample_size = n())

purple_urchins_table

```

## Graph Representing Summary Statistics
```{r}
ggplot(data = purple_urchins_table, aes( x = year, y = sample_size)) +
        geom_line(stat = "identity", size = 1)+
         aes(color = site_full) +
         labs(x = "Year",
              y = "Number of Urchins",
              title = "Purple Urchins Recorded at each Site 2008-2020",
              color = "Site Name") +
  theme_minimal()+
  theme(plot.title = element_text(hjust = 0.5,
                                  face = "bold"))+
  scale_x_continuous(breaks = seq(2008,2020,1))

```
Figure 2. ADD DESCRIPTION



